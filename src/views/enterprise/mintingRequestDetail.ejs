<%- include("../partials/head") %>
<%- include("../partials/navbar") %>
<!-- Section: Design Block -->
<section class="text-center">
  <!-- Background image -->
  <div class="p-5 bg-image" style="
    background-image: url('https://mdbootstrap.com/img/new/textures/full/171.jpg');
    height: 300px;
    ">
  <h2 class="fw-bold mb-5">Please upload all your unplastified items</h2>
  <h3 class="fw-bold mb-5">
    <%= mintingRequest.name  %> 
  </h3>
  </div>
  <!-- Background image -->
  <% let progresion; %>
<% switch (mintingRequest.minting_status.dataValues.status) {
  case 'Created':
    progresion = 10;
    break;
  case 'Submited':
    progresion = 30;
    break;
  case 'Approved':
    progresion = 60;
    break;
  case 'Rejected':
    progresion = 80;
    break;
  case 'Completed':
    progresion = 100;
    break;
  default:
    progresion = 0;
} %>
  <div class="card mx-4 mx-md-5 shadow-5-strong" style="
    margin-top: -100px;
    background: hsla(0, 0%, 100%, 0.8);
    backdrop-filter: blur(30px);
  ">
    <div class="card-body py-5 px-md-5">
      <div class="row d-flex justify-content-center">
        <div class="col-lg-8">
          <!-- hipervinculo a cada detalle de uni -->
          <!-- el estado de la mr -->
          <!-- boton para agregar unplastified item -->
          <!-- lista con todas las uni cargadas -->
          <% if(unplastifiedItems.length>0){ %>
          <% //if(unplastifiedItems){ %>
            <div class="table-wrapper-scroll-y my-custom-scrollbar">
              <table class="table table-bordered table-striped mb-0">
                <thead>
                  <tr>
                    <th scope="col">Plastic Item</th>
                  </tr>
                </thead>
                <tbody>
                  <% unplastifiedItems.forEach(e=>{ %>
                    <tr>
                      <td>
                          <%= e.dataValues.plastic_item %>
                        <button type="button" class="btn btn-outline-dark mt-auto" data-toggle="modal" data-target="<%= `.editmodal-${e.dataValues.unplastified_item_id}`%>">
                          Details
                        </button>
                        <% if (mintingRequest.minting_status.dataValues.status === 'Created') { %>
                          <button type="button" class="btn btn-outline-dark mt-auto" data-toggle="modal" data-target="<%= `.editmodal-${e.dataValues.unplastified_item_id}`%>">
                            Edit
                          </button>
                        <% } %>
                      </td>
                    </tr> 
                  <% }) %> 
              </tbody>
              </table>
            </div>
          <% } else {%>
            Please add unplastified items to continue 
          <% } %> 
            <br>
            <% if (mintingRequest.minting_status.dataValues.status === 'Created') { %>
              <form action="/enterprise/addUnplastifiedItem" method="GET">
                <!-- Add an unplastified item -->
                <input type="submit" class="btn btn-primary btn-block mb-4" value="Add new unplastified item"></input>
              </form>
            <% } %>
           <!-- unplastifiedItems, minting_request -->

          <!-- Project Card Example -->
          <div class="card shadow mb-4">
            <div class="card-header py-3">
              <h6 class="m-0 font-weight-bold text-primary">Status</h6>
            </div>
            <div class="card-body">
              <h4 class="small font-weight-bold">
                <%= mintingRequest.minting_status.dataValues.status %>
                <span class="float-right">
                  <%= progresion %>
                </span>
              </h4>
              <div class="progress mb-4">
                <div class="progress-bar bg-danger" role="progressbar" style="width: <%= progresion %>% " 
                    aria-valuenow="<%= progresion %>" aria-valuemin="0" aria-valuemax="100">
                </div>
              </div>
                <!-- <h4 class="small font-weight-bold">Sales Tracking <span
                        class="float-right">40%</span></h4>
                <div class="progress mb-4">
                    <div class="progress-bar bg-warning" role="progressbar" style="width: 40%"
                        aria-valuenow="40" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <h4 class="small font-weight-bold">Customer Database <span
                        class="float-right">60%</span></h4>
                <div class="progress mb-4">
                    <div class="progress-bar" role="progressbar" style="width: 60%"
                        aria-valuenow="60" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <h4 class="small font-weight-bold">Payout Details <span
                        class="float-right">80%</span></h4>
                <div class="progress mb-4">
                    <div class="progress-bar bg-info" role="progressbar" style="width: 80%"
                        aria-valuenow="80" aria-valuemin="0" aria-valuemax="100"></div>
                </div>
                <h4 class="small font-weight-bold">Account Setup <span
                        class="float-right">Complete!</span></h4>
                <div class="progress">
                    <div class="progress-bar bg-success" role="progressbar" style="width: 100%"
                        aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                </div> -->
            </div>
        </div>
          <form action="<%= `/enterprise/submitMintingRequest/${mintingRequest.minting_request_id}?_method=PUT` %>" method="POST" enctype="multipart/form-data">
            <!-- Submit button -->
            <input type="submit" class="btn btn-primary btn-block mb-4" value="submit minting request"></input>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
<%- include("./modals")%>
<%- include("./editModal")%>
<%- include("../partials/footer") %>
